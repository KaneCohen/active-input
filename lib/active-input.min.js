/**
 * Active Input
 * version 0.3.1
 * Kane Cohen [KaneCohen@gmail.com] | https://github.com/KaneCohen
 * @preserve
 */
!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.returnExports=b()}(this,function(){"use strict";function a(a){this.o=d.extend(b,a),this.v=d.extend({},c),this.v.input=[],this.v.events={},this.init()}window.jQuery&&(jQuery.fn.activeInput=function(b){var c=[],e=arguments,f=null,g=jQuery.extend(!0,{},b);return this.each(function(){g.element=jQuery(this)[0],f=d.data("activeInput"),f?(f.trigger.apply(f,e),c.push(f.o.element)):"string"!=jQuery.type(b)&&(f=new a(g))}),1==c.length?c[0]:c.length>1?c:this});var b={element:null,minChars:1,maxChars:null,stripHtml:!1,button:null,counter:null,count:"up",form:!1,input:null},c={initData:null,button:null},d={checkable:/(checkbox|radio)/,key:/[a-z0-9_-]+|(?=\[\])/gi,events:{},trim:function(a){return a.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"")},extend:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},data:function(a,b,c){var d="data",e=a[d]||{};if("undefined"==typeof c){if(a[d]&&a[d][b])return a[d][b];var f=a.getAttribute(d+"-"+b);return"undefined"!=typeof f?f:null}return e[b]=c,a[d]=e,a},on:function(a,b,c){var d,e,f=this.data(a,"events")||{};if("string"==typeof b){for(b=b.match(/[\S]+/g),e=0;e<b.length;e++)d=b[e],f[d]?f[d].push(c):f[d]=[c],a.addEventListener(d.split(".")[0],c);this.data(a,"events",f)}},off:function(a,b,c){var d,e,f,g,h=this.data(a,"events")||{};if("string"==typeof b)for(b=b.match(/[\S]+/g),e=0;e<b.length;e++)if(d=b[e],c)a.removeEventListener(d.split(".")[0],c);else if(h[d])for(f=0;f<h[d].length;f++)a.removeEventListener(d.split(".")[0],h[d][f]),h[f]=h[d].slice(f+1);else if("."===d[0])for(f in h){if(f.indexOf(d)>-1)for(g=0;g<h[f].length;g++)a.removeEventListener(f.split(".")[0],h[f][g]),h[f]=h[f].slice(g+1);0===h[f].length&&delete h[f]}},parents:function(a,b){b||(b=[]);var c=a.parentNode;return c&&(b.push(c),this.parents(c,b)),b},isDisabled:function(a){var b=!1;return a.disabled?!0:(this.parents(a).forEach(function(a){"FIELDSET"==a.tagName&&a.disabled&&(b=!0)}),b)},findInputElements:function(a){var b=this,c=a.querySelectorAll("input, select, textarea, keygen");return c=Array.prototype.filter.call(c,function(a){if(a.name&&!b.isDisabled(a)){var c=b.checkable.test(a.type);if(c&&a.checked||!c)return!0}return!1})},serializeObject:function(a){var b=this,c={},d=this.findInputElements(a);return d.forEach(function(a){var d=a.name.match(key);b.buildObject(a,c,d)}),c},serialize:function(a){var b,c={},d="",e=this.findInputElements(a);e.forEach(function(a){var b=a.name;c[b]=a.value});for(b in c)d+=encodeURIComponent(b)+"="+encodeURIComponent(c[b]);return d},buildObject:function(a,b,c){var d,e,f,g=c.length;for(e=0;g-1>e;e++)f=c[e],f.length>0?(b[f]||(b[f]=0===c[e+1].length?[]:{}),b=b[f]):(0===c[e+1].length?(d=[],b.push(d)):(d={},b.push(d)),b=d);return f=c[g-1],f.length>0?b[f]=a.value:b.push(a.value),b}};return a.prototype={init:function(){var a,b,c=this,e=this.o;if(d.data("activeInput",this),"string"==typeof e.element&&(e.element=document.querySelector(e.element)),e.form||null!==e.input||(e.input=e.element.querySelector("input, textarea, select")),e.input instanceof Array?e.input.forEach(function(d){0!==d.input.length&&(a=d.input,b=d.counter||e.counter,"string"==typeof a&&(a=e.element.querySelector(a)),"string"==typeof b&&(b=e.element.querySelector(b)),c.v.input.push({input:a,counter:b,count:d.count||e.count,minChars:d.minChars||e.minChars,maxChars:d.maxChars||e.maxChars,stripHtml:d.stripHtml||e.stripHtml,form:!1}))}):e.input&&(a=e.input,b=e.counter,"string"==typeof a&&(a=e.element.querySelectorAll(a)),"string"==typeof b&&(b=e.element.querySelector(b)),"undefined"==typeof a.length&&(a=[a]),Array.prototype.forEach.call(a,function(a){c.v.input.push({input:a,counter:b,count:e.count,minChars:e.minChars,maxChars:e.maxChars,stripHtml:e.stripHtml,form:!1})})),e.form){var f=e.form;"string"==typeof e.form&&(f=document.querySelector(e.form),e.element||(e.element=f)),this.v.input.push({input:f,form:!0}),this.v.initData=d.serialize(f)}if(0===this.v.input.length)return console.log("ActiveInput.Error: activeInput must be bind to at least one input element."),!1;if(this.v.button=e.button,null===this.o.button){var g=e.element.querySelectorAll("button");if(0===g.length&&(g=e.element.querySelectorAll('input[type="submit"]')),0===g.length)return console.log("ActiveInput.Error: activeInput container must have button or submit element available."),!1;this.v.button=g[g.length-1]}return this.o.form&&(this.v.button.disabled=!0),this.v.button.disabled=this.validate()?!1:!0,this.initEvents(),this.o.element.activeInput=this,this},initEvents:function(){var a=this;this.refresh(),this.v.input.forEach(function(b){if(b.form)d.on(b.input,"input.activeInput change.activeInput reset.activeInput",function(c){setTimeout(function(){a.v.button.disabled=a.validate(b.input,c)?!1:!0,a.trigger("stop",a,c)},1)}),d.on(b.input,"submit.activeInput",function(){a.v.button.disabled=!0,a.v.initData=d.serialize(b.input)});else{var c=b.input.value;d.on(b.input,"input.activeInput change.activeInput",function(e){var f=d.trim(b.input.value).replace(/[\s]/gi,"");if(b.stripHtml&&(f=f.replace(/(<([^>]+)<)/gi,"")),f!==c){if(b.counter){var g;"up"===b.count&&null!==b.minChars&&(g=a.length(f)-b.minChars,b.counter.innerHTML=g,0>g?b.counter.classList.add("negative"):b.counter.classList.remove("negative")),"down"===b.count&&null!==b.maxChars&&(g=b.maxChars-a.length(f),b.counter.innerHTML=g,0>g?b.counter.classList.add("negative"):b.counter.classList.remove("negative"))}a.v.button.disabled=a.validate(b.input,e)?!1:!0,c=f}}),d.on(b.input,"focusout.activeInput",function(b){a.trigger("stop",a,b)})}}),d.on(this.v.button,"click.activeInput",function(b){a.trigger("click",a,b)})},validate:function(a,b){var c=this;if(c.trigger("update",this,a,b)){var e=!0;return this.v.input.forEach(function(a){if(a.form){if(d.serialize(a.input)==c.v.initData)return e=!1,!1}else{var b=c.length(a.input.value);if(null!==a.minChars&&b<a.minChars)return e=!1,!1;if(null!==a.maxChars&&b>a.maxChars)return e=!1,!1}}),e}return!1},reset:function(){var a=this;this.v.input.forEach(function(b){b.form&&(a.v.initData=d.serialize(b.input),a.v.button.disabled=!0)})},refresh:function(){var a=this;this.v.input.forEach(function(b){if(b.counter){var c,d=b.input.value;"up"==b.count&&null!==b.minChars&&(c=a.length(d)-b.minChars,b.counter.innerHTML=c,0>c?b.counter.classList.add("negative"):b.counter.classList.remove("negative")),"down"==b.count&&null!==b.maxChars&&(c=b.maxChars-a.length(d),b.counter.innerHTML=c,0>c?b.counter.classList.add("negative"):b.counter.classList.remove("negative"))}})},destroy:function(){Array.isArray(this.v.input)?this.v.input.forEach(function(a){d.off(a.input,".activeInput")}):d.off(this.v.input,".activeInput"),d.off(this.o.element,".activeInput"),delete this.o.element.activeInput},length:function(a){return d.trim(a).replace(/[\s]/gi,"").length},on:function(a,b){this.v.events[a]=b},off:function(a){delete this.v.events[a]},trigger:function(a){var b=Array.prototype.slice.call(arguments,1);return this.v.events[a]&&this.v.events[a].apply(this,b)===!1?!1:this[a]&&this[a].apply(this,b)===!1?!1:!0}},a});